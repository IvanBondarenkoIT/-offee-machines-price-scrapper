# üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Railway

## üö® –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å—Ç—ã–µ Deploy Logs

–î–∞–∂–µ —Å shell form CMD –ª–æ–≥–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è!

---

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Railway Dashboard

### 1. Service Settings ‚Üí Deploy

**Start Command**:
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å **–ø—É—Å—Ç–æ** (–∏—Å–ø–æ–ª—å–∑—É–µ–º CMD –∏–∑ Dockerfile)
- –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —É–∫–∞–∑–∞–Ω–æ - —É–¥–∞–ª–∏—Ç—å!

### 2. Service Settings ‚Üí Variables

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
```
PORT=8080  ‚Üê –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
```

–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

### 3. Service Settings ‚Üí Networking

**Domain**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–æ–º–µ–Ω —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- –ü–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 8080

### 4. Deployments ‚Üí View Source

**Branch**: –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å `main`

### 5. Service Settings ‚Üí Source

**Root Directory**: –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ (–∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

**Watch Paths**: –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ –∏–ª–∏ `**`

---

## üéØ –¢–µ–∫—É—â–∏–π —Ç–µ—Å—Ç: –ó–∞–ø—É—Å–∫ –æ—Ç root

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**:
```dockerfile
# –ë—ã–ª–æ:
USER appuser

# –°—Ç–∞–ª–æ (—Ç–µ—Å—Ç):
# USER appuser  ‚Üê –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
```

**–ü–æ—á–µ–º—É**:
Railway –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ –∏–º–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏.

**–ï—Å–ª–∏ –ª–æ–≥–∏ –ø–æ—è–≤—è—Ç—Å—è** ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ `USER appuser`

**–ï—Å–ª–∏ –ª–æ–≥–∏ –≤—Å—ë –µ—â–µ –ø—É—Å—Ç—ã** ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≥–ª—É–±–∂–µ (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Railway –∏–ª–∏ —á—Ç–æ-—Ç–æ –µ—â–µ)

---

## üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: Railway Service Type

Railway Dashboard ‚Üí Service:
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∏–ø **"Web Service"**
- –ù–ï "Cron Job" –∏–ª–∏ "Worker"

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: Railway Region

–í–∞—à —Ä–µ–≥–∏–æ–Ω: `europe-west4`
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–º–µ–Ω–∏—Ç—å –Ω–∞ `us-west1` –¥–ª—è —Ç–µ—Å—Ç–∞?

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: Railway Restart Policy

Settings ‚Üí Deploy:
- Restart Policy: Should be enabled
- Health Check: Disabled (–º—ã –æ—Ç–∫–ª—é—á–∏–ª–∏ –≤ Dockerfile)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: Railway Logs Retention

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Railway –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏.
–ù–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã - –ª–æ–≥–∏ –º–æ–≥—É—Ç –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è.

---

## üÜò –ï—Å–ª–∏ –ª–æ–≥–∏ –í–°–Å –ï–©–Å –ø—É—Å—Ç—ã –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ –±–µ–∑ USER

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dockerfile.minimal

–°–æ–∑–¥–∞—Ç—å –≤ Railway Settings:
```
Build Settings:
  Docker Build Args: -f Dockerfile.minimal
```

–ò–ª–∏:
```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–º–µ–Ω–∏—Ç—å Dockerfile –Ω–∞ minimal
mv Dockerfile Dockerfile.full
mv Dockerfile.minimal Dockerfile
git commit -am "Use minimal Dockerfile for debugging"
git push
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å ENTRYPOINT

```dockerfile
ENTRYPOINT ["/bin/sh", "-c"]
CMD ["echo 'TEST START' && python -m uvicorn api_server:app --host 0.0.0.0 --port 8080"]
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–∑–¥–∞—Ç—å start script –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

```bash
# start.sh
#!/bin/sh
set -e
echo "========== STARTUP =========="
pwd
ls -la
python --version
echo "Starting uvicorn..."
exec python -m uvicorn api_server:app --host 0.0.0.0 --port 8080
```

```dockerfile
COPY start.sh /start.sh
RUN chmod +x /start.sh
CMD ["/start.sh"]
```

---

## üìä –ß—Ç–æ Railway –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å

### Build Logs (–µ—Å—Ç—å):
```
‚úì [1/11] FROM python:3.11-slim
‚úì [2/11] RUN apt-get install...
...
‚úì Build time: 20.08 seconds
```

### Deploy Logs (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å, –Ω–æ –ø—É—Å—Ç–æ):
```
========== Starting Coffee Price Monitor API ==========
Working directory: /app
...
INFO: Started server process
INFO: Uvicorn running on http://0.0.0.0:8080
```

---

## üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

1. **–°–µ–π—á–∞—Å**: –¢–µ—Å—Ç –±–µ–∑ USER appuser
2. **–ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dockerfile.minimal
3. **–ï—Å–ª–∏ –∏ —ç—Ç–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Railway
4. **–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç**: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –Ω–∞ Railway —Å –Ω—É–ª—è

---

## üí° –í–æ–∑–º–æ–∂–Ω–æ Railway —Ç—Ä–µ–±—É–µ—Ç:

1. **Health check endpoint** - –Ω–æ —É –Ω–∞—Å –µ—Å—Ç—å `/health`
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤** - –Ω–æ echo –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å
3. **–Ø–≤–Ω—ã–π ENTRYPOINT** - –ø–æ–ø—Ä–æ–±—É–µ–º –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Ç–µ—Å—Ç –Ω–µ –ø–æ–º–æ–∂–µ—Ç
4. **–ó–∞–ø—É—Å–∫ –æ—Ç root** - —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–µ–π—á–∞—Å

---

**–î–∞—Ç–∞**: 2025-10-14  
**–¢–µ—Å—Ç**: –ë–µ–∑ USER appuser  
**–û–∂–∏–¥–∞–Ω–∏–µ**: –õ–æ–≥–∏ –î–û–õ–ñ–ù–´ –ø–æ—è–≤–∏—Ç—å—Å—è!

