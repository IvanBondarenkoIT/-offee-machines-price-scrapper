# üß™ Tests - Scraper Health Checks

–ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∫—Ä–∞–ø–µ—Ä–æ–≤.

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±
```bash
python run_tests.py
```

### –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫
```bash
python tests/test_alta_scraper.py
```

## üìä –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### ‚úÖ Unit Tests (–±—ã—Å—Ç—Ä–æ, <5 —Å–µ–∫)

1. **Model Extraction** - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã
   - –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π
   - –ü—Ä–∏–º–µ—Ä—ã: `(ECAM22.114.B)`, `EC685.R`, `DLSC310`

2. **Model Matching** - –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
   - –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
   - Case-insensitive —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
   - Fuzzy match (–≤–∞—Ä–∏–∞–Ω—Ç—ã —Ü–≤–µ—Ç–æ–≤)

3. **Price Cleaning** - –û—á–∏—Å—Ç–∫–∞ —Ü–µ–Ω
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ –≤–∞–ª—é—Ç—ã
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ float

### ‚úÖ Integration Test (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, ~30-60 —Å–µ–∫)

**ALTA BS4 Quick Test**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É ALTA
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –º–∏–Ω–∏–º—É–º 10 —Ç–æ–≤–∞—Ä–æ–≤
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (—Ü–µ–Ω—ã numeric)

## üéØ –¶–µ–ª—å —Ç–µ—Å—Ç–æ–≤

### –ù–µ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
–≠—Ç–∏ —Ç–µ—Å—Ç—ã –ù–ï –∑–∞–º–µ–Ω—è—é—Ç –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –û–Ω–∏ –¥–ª—è:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ "–Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞–ª–æ—Å—å"
- ‚úÖ Smoke test –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

### –ß—Ç–æ –ù–ï —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è
- ‚ùå –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö 74 —Ç–æ–≤–∞—Ä–æ–≤ (—Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ)
- ‚ùå –û–±—Ö–æ–¥ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤ (—Å–ª–∏—à–∫–æ–º —Ö—Ä—É–ø–∫–æ–µ)
- ‚ùå –¢–æ—á–Ω–æ—Å—Ç—å –≤—Å–µ—Ö XPath (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç–∞ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è)

## üìù –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                  SCRAPER HEALTH CHECK                            ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

### UNIT TESTS ###

============================================================
TEST: Model Extraction
============================================================
[OK] DeLonghi Magnifica S (ECAM22.114.B)  -> ECAM22.114.B
[OK] DeLonghi Dinamica (ECAM350.55.B)     -> ECAM350.55.B
[RESULT] 5/5 tests passed (100%)

============================================================
TEST SUMMARY
============================================================
[PASS] Model Extraction
[PASS] Model Matching
[PASS] Price Cleaning
[PASS] ALTA BS4 Quick Test

Total: 4/4 tests passed (100%)

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                    ‚úì ALL TESTS PASSED                           ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

### –ü—Ä–æ–≤–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
```
[FAIL] Assertion failed: Expected at least 10 products, got 0

[WARNING] 1 test(s) failed
```

## ‚öôÔ∏è –ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å

### –†–µ–≥—É–ª—è—Ä–Ω–æ
- üìÖ **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cron/Task Scheduler
- üîÑ **–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- üì¶ **–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º** - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- üîß –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∫—Ä–∞–ø–µ—Ä–æ–≤
- üìù –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è utils
- üåê –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚öôÔ∏è –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è config.py

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

### Windows Task Scheduler
```powershell
# –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –Ω–∞ –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 8:00
$action = New-ScheduledTaskAction -Execute 'python' -Argument 'D:\CursorProjects\Coffee machines price scrapper\run_tests.py'
$trigger = New-ScheduledTaskTrigger -Daily -At 8am
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName "ScraperHealthCheck"
```

### Linux Cron
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 8:00)
0 8 * * * cd /path/to/project && python run_tests.py >> logs/tests.log 2>&1
```

## üìà –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞

```python
# tests/test_elite_scraper.py
def test_elite_scraper_quick():
    """Quick test for ELITE scraper"""
    # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ test_alta_scraper_quick
    pass
```

### –î–æ–±–∞–≤–∏—Ç—å –≤ runner

```python
# run_tests.py
from tests.test_elite_scraper import test_elite_scraper_quick

# –í run_all_tests()
results.append(("ELITE Quick Test", test_elite_scraper_quick()))
```

## üêõ Troubleshooting

### "Driver setup failed"
**–ü—Ä–æ–±–ª–µ–º–∞**: ChromeDriver –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º

**–†–µ—à–µ–Ω–∏–µ**:
```bash
pip install --upgrade webdriver-manager selenium
```

### "Connection timeout"
**–ü—Ä–æ–±–ª–µ–º–∞**: –°–∞–π—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –º–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –£–≤–µ–ª–∏—á–∏—Ç—å timeout –≤ config.py
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ

### "Expected 10 products, got 0"
**–ü—Ä–æ–±–ª–µ–º–∞**: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –∏–ª–∏ –∑–∞—â–∏—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∞–π—Ç –≤—Ä—É—á–Ω—É—é
- –û–±–Ω–æ–≤–∏—Ç—å XPath/—Å–µ–ª–µ–∫—Ç–æ—Ä—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å User-Agent

## üìä –ú–µ—Ç—Ä–∏–∫–∏

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- Unit tests: **< 5 —Å–µ–∫—É–Ω–¥**
- Integration test: **30-60 —Å–µ–∫—É–Ω–¥**
- **–í—Å–µ–≥–æ**: **~1 –º–∏–Ω—É—Ç–∞**

### Coverage
- ‚úÖ Model extraction: 100%
- ‚úÖ Price cleaning: 100%
- ‚úÖ Basic scraping: 100%
- ‚ö†Ô∏è Full scraping: –ù–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è (—Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ)

---

**–°–æ–≤–µ—Ç**: –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–∏ —Ç–µ—Å—Ç—ã —á–∞—Å—Ç–æ! –û–Ω–∏ –±—ã—Å—Ç—Ä—ã–µ –∏ –ø–æ–º–æ–≥—É—Ç –ø–æ–π–º–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Ä–∞–Ω–æ.

